#!/usr/bin/env sh
set -e

echo "ğŸ›ï¸ [husky] Starting pre-commit checks..."

if ! command -v pnpm >/dev/null 2>&1; then
  echo "âŒ 'pnpm' not found. Please install it."
  exit 1
fi

cd client || {
  echo "âŒ Failed to cd into 'client'."
  exit 1
}

echo "ğŸ§ª Running Biome lint..."
pnpm biome lint --write ./src

echo "ğŸ¨ Formatting..."
pnpm biome format --write ./src

echo "ğŸ” Checking for TypeScript errors..."
if tsc --noEmit -p tsconfig.app.json && tsc --noEmit -p tsconfig.node.json; then
  echo "âœ… No TypeScript errors found."
else
  echo "âŒ Found TypeScript errors."
  exit 1
fi
echo "ğŸ“Œ Restaging changed files..."
git add ./src

echo "âœ… Pre-commit checks complete."
